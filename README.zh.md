- # Agent

  [英文版](README.md) | [中文版](README.zh.md)

  一个支持插件机制的智能代理框架，可通过 CLI 或 GUI 方式运行。

  ## 功能概览

  | 模块         | 功能描述                                                     |
  | ------------ | ------------------------------------------------------------ |
  | **对话管理** | - 多轮对话上下文管理<br>- 支持 CLI / GUI<br>- 可切换 LLM 提供商（OpenAI、Gemini、DeepSeek） |
  | **插件系统** | 插件式架构，支持扩展功能，如文件操作等                       |
  | **图形界面** | - 聊天窗口（气泡式展示）<br>- 工具栏（方法快照、导航栏、标题栏）<br>- 设置面板（模型、对话、语音） |
  | **接口服务** | - 基于 FastAPI 的聊天接口<br>- 支持对话创建与管理            |

  ## 发展规划

  | 模块           | 规划功能描述                                                 |
  | -------------- | ------------------------------------------------------------ |
  | **集群模式**   | 多 Agent 节点协作：每个节点专注于自己擅长的能力（分布式调度） |
  | **插件扩展**   | 增加数据库操作、自动化任务、外部服务接入等更多插件           |
  | **模型支持**   | 扩展接入更多大语言模型（Claude、Llama、Qwen 等）             |
  | **多模态支持** | 支持语音输入输出、图片/文件解析                              |

  ---

  ## 快速开始

  ### 1. 环境准备

  确保安装 Python 3.10+（推荐使用 conda 管理环境）：

  ```bash
  pip install -r requirements.txt
  ```

在根目录的 `config.json` 文件中配置 API KEY：

`provider` 支持：`deepseek`、`gemini`、`openai`。

### 2. 启动方式

- CLI 模式（命令行）：

```
python main_cli.py
```

- GUI 模式（图形界面）：

```
python main_gui.py
```

### 3. 项目结构

```
├─agent/            # 核心代理模块（对话、任务调度、RPC）
├─api/              # FastAPI 路由（聊天 / 会话接口）
├─assets/           # 界面样式资源（QSS）
├─common/           # 公共模块（错误码等）
├─model/            # 数据模型（Pydantic Schema）
├─plugins/          # 插件模块（命令执行 / 报表 / 文件操作等）
├─ui/               # GUI（PyQt 组件与窗口）
├─utils/            # 工具函数
│
├─config.json       # 默认配置
├─main_cli.py       # CLI 启动入口
├─main_gui.py       # GUI 启动入口
├─requirements.txt  # 依赖列表
└─README.md
```

### 4. 插件使用

添加插件步骤：

1. 在 `plugins/` 下创建新文件夹，作为独立模块；
2. 添加 `__init__.py` 文件，将其标记为 Python 包；
3. 在 `.py` 文件中实现功能，并使用 `@register_method` 装饰器暴露方法；
4. 加载后可在 `runtime` 方法快照中确认方法是否注册成功。

`@register_method` 支持字段：

| 字段名           | 描述                                        |
| ---------------- | ------------------------------------------- |
| name             | 方法名称（必填）                            |
| param_desc       | 参数描述（必填，无参数时使用 `param=None`） |
| description      | 方法用途描述（必填，便于 LLM 理解功能意图） |
| needs_nlg        | 是否需要二次模型响应（默认 `false`）        |
| tool_result_wrap | 是否返回 RPC 结果（默认 `false`）           |

### 5. 内置插件

| 插件包  | 描述      | 是否验证 | 说明                                            |
| ------- | --------- | -------- | ----------------------------------------------- |
| exec    | 命令执行  | ❌        | 支持执行本地命令（如 pip 安装），存在安全风险   |
| network | HTTP 请求 | ❌        | 支持 HTTP/HTTPS，代理与超时未完全测试           |
| report  | 报表示例  | ✅        | 示例插件，生成演示结果                          |
| system  | 文件操作  | ✅        | 支持读/写/创建/删除本地文件，请在安全目录下使用 |

### ⚠️ 注意事项

- 某些插件（如 `exec`、`system`）存在安全风险，请谨慎使用；
- `exec` 插件依赖系统命令（如 pip、ls 等）；
- `network` 插件尚未完全验证；
- 使用前请确保插件的提示词和参数正确。
